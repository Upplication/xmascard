function init(){time=0,count=0;for(var t=0;t<arc;t++)lights[t]={x:Math.ceil(Math.random()*w),y:Math.ceil(Math.random()*h),toX:5*Math.random()+1,toY:5*Math.random()+1,c:colors[Math.floor(Math.random()*colors.length)],size:Math.random()*size}}function bubble(){ctx.clearRect(0,0,w,h);for(var t=0;t<arc;t++){var s=lights[t];ctx.beginPath(),ctx.arc(s.x,s.y,s.size,0,2*Math.PI,!1),ctx.fillStyle=s.c,ctx.fill(),s.x=s.x+s.toX*(.05*time),s.y=s.y+s.toY*(.05*time),s.x>w&&(s.x=0),s.y>h&&(s.y=0),s.x<0&&(s.x=w),s.y<0&&(s.y=h)}time<speed&&time++,timerID=setTimeout(bubble,1e3/rate)}!function(t,s){function e(t){this.setLevels=function(){this.docWidth>1500?(this.levels=6.2,this.verticalTranslate=3e3):this.docWidth>1350?(this.levels=6,this.verticalTranslate=2750):this.docWidth>1250?(this.levels=5.8,this.verticalTranslate=2450):this.docWidth>1150?(this.levels=5.7,this.verticalTranslate=2350):this.docWidth>1050?(this.levels=5.5,this.verticalTranslate=2100):this.docWidth>950?(this.levels=5.35,this.verticalTranslate=1900):this.docWidth>850?(this.levels=5.15,this.verticalTranslate=1700):(this.levels=4.9,this.verticalTranslate=1520)},this.content=t,this.header=s(".page-header"),this.body=s("body"),this.town=s(".illust-level--town"),this.townSymbols=s(".illust-level--symbolsTown"),this.house=s(".svg-house"),this.carollers=s(".svg-carollers"),this.star=s(".svg-star"),this.scrolled=0;var e=document.body,i=document.documentElement;this.docHeight=Math.max(e.scrollHeight,e.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight),this.docWidth=i.clientWidth,this.setLevels(),window.addEventListener("scroll",this,!1)}s(function(){t.UI.init()}),t.UI={scrollActive:!1,supports:{transform3d:!1},init:function(){this.handleZooming()},handleZooming:function(){var t=s(".illust-container");ZUI=new e(t),window.scrollTo(0,0)}},e.prototype.handleEvent=function(t){this[t.type]&&this[t.type](t)},e.prototype.scroll=function(t){this.recalculatePositions()},e.prototype.recalculatePositions=function(){var s=350,e=320,i=80,o=void 0!==window.pageXOffset,a="CSS1Compat"===(document.compatMode||""),l=o?window.pageYOffset:a?document.documentElement.scrollTop:document.body.scrollTop;this.scrolled=l/(this.docHeight-window.innerHeight);var n,r,h;this.checkStates();var c=this.scrolled<.5?this.scrolled:.5,d=Math.pow(3,c*this.levels),m=Math.round(d*e),v=Math.round(d*s),y=Math.round(d*i)-i;if(c<.5){var u=Math.round(m/2+y);t.UI.supports.transform3d?(n="translate3d(0, 0, 0) scale("+d+")",r="translate3d(-50%, -"+u+"px, 0)",h="translate3d(-"+v/2+"px, -"+u+"px, 0) scale("+d+")"):(n="translate(0, 0) scale("+d+")",r="translate(-50%, -"+u+"px)",h="translate(-"+v/2+"px, -"+u+"px) scale("+d+")")}else{var w=(this.scrolled-.5)/.5,f=w*this.verticalTranslate,u=Math.round(m/2+y-f);t.UI.supports.transform3d?(n="translate3d(0, 0, 0) scale("+d+")",r="translate3d(-50%, -"+u+"px, 0)"):(n="translate(0, 0) scale("+d+")",r="translate(-50%, -"+u+"px)")}this.town[0].style.width=v+"px",this.town[0].style.height=m+"px",this.town[0].style.WebkitTransform=r,this.town[0].style.MozTransform=r,this.town[0].style.msTransform=r,this.town[0].style.transform=r,this.content[0].style.WebkitTransform=n,this.content[0].style.MozTransform=n,this.content[0].style.msTransform=n,this.content[0].style.transform=n,this.townSymbols[0].style.WebkitTransform="scale("+d+")",this.townSymbols[0].style.MozTransform="scale("+d+")",this.townSymbols[0].style.msTransform="scale("+d+")",this.townSymbols[0].style.transform="scale("+d+")"},e.prototype.checkStates=function(){this.scrolled>0?this.header.addClass("scaled"):this.header.removeClass("scaled"),this.scrolled>.15?this.body.addClass("night"):this.body.removeClass("night"),this.scrolled<.5?(this.house.removeClass("inactive"),this.carollers.removeClass("inactive"),this.star.addClass("inactive"),this.townSymbols.find(".symbols--inside").addClass("inactive"),this.townSymbols.find(".symbols--outside").removeClass("inactive")):(this.house.addClass("inactive"),this.carollers.addClass("inactive"),this.star.removeClass("inactive"),this.townSymbols.find(".symbols--inside").removeClass("inactive"),this.townSymbols.find(".symbols--outside").addClass("inactive"))}}(window.KO=window.KO||{},jQuery);var w=window.innerWidth,h=window.innerHeight,canvas=document.getElementById("snow"),ctx=canvas.getContext("2d"),rate=50,arc=500,time,count,size=2,speed=10,lights=new Array,colors=["#eee"];canvas.setAttribute("width",w),canvas.setAttribute("height",h),init(),bubble();